# vim: ft=tmpl.toml
encryption = "age"
sourceDir = "{{ .chezmoi.homeDir }}/dotfiles"
interactive = true

[gpg]
recipient = "FD235DFD"

[age]
identities = [
  '{{ joinPath (dir .chezmoi.configFile) "keys" "personal.txt" }}',
  '{{ joinPath (dir .chezmoi.configFile) "keys" "delegator.txt" }}'
]
recipients = [
  "age1y5xgp4msrrhylvla0hcm7srsfjeql56p4ugfwsl89wsjs92vkvts3u5xxa",
  "age12kvky80hkmhhftqxwhytkte6vfus7yy9n2uay3kt3zs7yp9pt4rsf6q2qp"
]

[git]
autoAdd = true
autoCommit = true
autoPush = true

[diff]
{{ if lookPath "difft" -}}
command = "difft"
args = ["--color", "always", "{{ "{{" }} .Destination {{ "}}" }}", "{{ "{{" }} .Target {{ "}}" }}"]
{{ else if lookPath "delta" -}}
command = "delta"
args = ["{{ "{{" }} .Destination {{ "}}" }}", "{{ "{{" }} .Target {{ "}}" }}"]
{{ else -}}
command = "diff"
args = ["{{ "{{" }} .Destination {{ "}}" }}", "{{ "{{" }} .Target {{ "}}" }}"]
{{- end }}
pager = "less -FR"

[merge]
{{- if lookPath "nvim" }}
command = "nvim"
args = [ "-c", "+':norm gg'", "-d", "{{ "{{" }} .Destination {{ "}}" }}", "{{ "{{" }} .Source {{ "}}" }}", "{{ "{{" }} .Target {{ "}}" }}"]
{{ end }}

[edit]
{{- if lookPath "nvim" }}
command = "nvim"
args = ["-c", "cd {{ .chezmoi.sourceDir }}"]
{{ end }}
watch = false
apply = true

[data.xdg]
{{ $xdg_config_dir := joinPath .chezmoi.homeDir ".config" -}}
configDir = "{{ $xdg_config_dir }}"
{{ $xdg_data_dir := joinPath .chezmoi.homeDir ".local" "share" -}}
dataDir = """{{ $xdg_data_dir }}"""
stateDir = """{{ joinPath .chezmoi.homeDir ".local" "state" }}"""
cacheDir = """{{ joinPath .chezmoi.homeDir ".cache" }}"""

[data.mise]
{{ $mise_exe := joinPath .chezmoi.homeDir ".local" "bin" "mise" -}}
exe = "{{ $mise_exe }}"
configDir = """{{ joinPath $xdg_config_dir "mise" }}"""
shimsDir = """{{ joinPath $xdg_config_dir "mise" "shims" }}"""

[data.nushell]
{{ $nu_dir := joinPath $xdg_config_dir "nushell" -}}
configDir = "{{ $nu_dir }}"
configFile = """{{ joinPath $nu_dir "config.nu" }}"""
envFile = """{{ joinPath $nu_dir "env.nu" }}"""
libDir = """{{ joinPath $nu_dir "scripts" }}"""
{{ $nu_exe := cat $mise_exe "exec" "nushell@0.109.1" "--" "nu" -}}
exe = "{{ $nu_exe }}"
shebang = "#!/usr/bin/env -S {{ $nu_exe }}"

[data.zdotdir]
{{ $zdotdir := joinPath $xdg_config_dir "zsh" -}}
path = "{{ $zdotdir }}"
prezto = """{{- joinPath $zdotdir "zprezto" -}}"""
runcoms = """{{- joinPath $zdotdir "zprezto" "runcoms" -}}"""
