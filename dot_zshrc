# vim: ft=zsh

#
# Options
#

setopt AUTO_CD
setopt AUTO_PUSHD
setopt EXTENDED_GLOB

#
# Bindings
#

# Use vim-style key bindings
bindkey -v
bindkey -v '^?' backward-delete-char
autoload edit-command-line
zle -N edit-command-line
bindkey -M vicmd 'v' edit-command-line

#
# Autoload Functions
#
for func in "$HOME"/.local/functions/*(N:t); do
  autoload -Uz $func
done

#
# Autocomplete
#

autoload -Uz compinit
compinit
# autoload -U +x bashcompinit && bashcompinit

# Enable path completion for multiple segments
zstyle ':completion:*' completer _complete _ignored _approximate

# Syntax Highlighting
source "$XDG_STATE_HOME"/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh # broken syntax highlighting

#
# Third-party
#

# Starship
eval "$(starship init zsh)"
# broken syntax highlighting

# SSH Agent
eval $(ssh-agent -s)
for k in "$HOME"/.ssh/id_^*.pub; do 
  ssh-add --apple-use-keychain $k
done

#
# Aliases
#

# Global

alias -g P='| ${(z)PAGER}'
alias -g HP='--help 2>&1 | ${(z)PAGER}'
alias -g HF='--help 2>&1 | gum filter'

# Suffix


# Normal

alias c='chezmoi'
alias lg='lazygit'
alias ls='eza'
alias tmuxl="tmux ls -F '#S' | gum filter"
alias txa="tmux ls -F '#S' | gum choose | read session; tmux attach -t \$session"
alias txa="tmuxp ls | gum filter | xargs -I{} zsh -c 'tmuxp load -d {} && tmux switch -t {}'"
alias txe='tmuxp ls | gum filter | xargs -I{} nvim ~/.config/tmuxp/{}.yml'
