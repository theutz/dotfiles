# vim: ft=sh fdm=marker fdl=0 fmr=\ »»»,\ «««

# functions »»»
function brew-readme() {
  brew info "$1" --json |
    jq -r '.|first|.urls.stable.url' |
    gsed -e 's|^https\?://||' |
    awk -F/ '{ print $1 "/" $2 "/" $3 }' |
    xargs glow -p
}

function tmuxp-attach() {
  filename=$(tmuxp ls | fzf)
  file="${XDG_CONFIG_HOME:-$HOME/.config}"/tmuxp/"$filename".yml
  session=$(yq '.session_name' "$file")

  if ! tmux has -t "$session"; then
    tmuxp load -d "$filename"
  fi

  if [[ -n "$TMUX" ]]; then
    tmux switch-client -t "$session"
  else
    tmux attach-client -t "$session"
  fi
}
#  «««

# global aliases »»»
alias -g P='| ${(z)PAGER}'
alias -g HP='--help 2>&1 | ${(z)PAGER}'
#  «««

# chezmoi »»»
alias cm='chezmoi'
alias cma='chezmoi add'
alias cmap='chezmoi apply'
alias cmcat='chezmoi cat'
alias cmcd='chezmoi cd'
alias cmdata='chezmoi data'
alias cmdf='chezmoi diff'
alias cme='chezmoi edit'
alias cmea='chezmoi edit --apply'
alias cmec='chezmoi edit-config-template'
alias cmew='chezmoi edit --apply --watch'
alias cmex='chezmoi execute-template'
alias cmf='chezmoi forget'
alias cmg='chezmoi git'
alias cmi='chemzoi init'
alias cmgws='chezmoi git status'
alias cmlg='lazygit -p $(chezmoi execute-template "{{ .chezmoi.config.sourceDir }}")'
alias cmls='chezmoi managed'
alias cmlsi='chezmoi unmanaged'
alias cmm='chezmoi merge'
alias cmma='chezmoi merge-all'
alias cmra='chezmoi re-add'
alias cmrm='chezmoi destroy'
alias cms='chezmoi status'
alias cmsp='chezmoi source-path'
alias cmtp='chezmoi target-path'
alias cmup='chezmoi update'
#  «««

# edit config files »»»
alias e-zsh='chezmoi edit --watch --apply ~/.z{alias,sh{env,rc},log{in,out},preztorc,profile}; exec zsh'
alias e-nvim='chezmoi edit --watch --apply ~/.config/nvim'
alias e-tmux='chezmoi edit --watch --apply ~/.config/tmux/tmux.conf'
alias e-ham='chezmoi edit --watch --apply ~/.hammerspoon'
alias e-tmuxp='chezmoi edit --watch --apply ~/.config/tmuxp'
alias e-brew='chezmoi edit --watch --apply ~/.Brewfile'
#  «««

# tmux »»»
alias t='tmux'
alias txp='tmuxp'
alias txpls='tmuxp ls'
#  «««

# homebrew »»»
alias brewr='brew-readme'
#  «««

alias lg='lazygit'
alias ls='eza --group-directories-first --icons'
alias reload='exec zsh'
alias rl='exec zsh'
